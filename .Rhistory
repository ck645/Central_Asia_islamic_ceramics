.groups = "drop"
)
# clean averaged data
Comp_Glaze <- Comp_Glaze %>%
rename_with(~ gsub("_Mean$", "", .x), ends_with("_Mean")) %>%
mutate(
alkali = rowSums(select(., Na2O, MgO, Al2O3, K2O, CaO), na.rm = TRUE),
PbO    = coalesce(PbO, 1e-5)
)
opaque_set       <- c("Alkali", "Ishkor", "Lustreware", "Opaque")
transparent_set  <- c("Slipware - Qarakhanid", "Slipware - Samanid", "Slipware", "Splashed", "Underglaze", "Monochrome")
other_set        <- c("Kiln Furniture", "Undetermined", "Unknown")
Comp_Glaze <- Comp_Glaze %>%
mutate(
Ware_type = case_when(
Ware %in% opaque_set      ~ "Opaque",
Ware %in% transparent_set ~ "Transparent",
Ware %in% other_set       ~ "Other",
TRUE                      ~ "Other"
),
Ware_type = factor(Ware_type, levels = c("Opaque","Transparent","Other"))
)
unique_glaze_type_per_Site <- Comp_Glaze %>%
group_by(Site, Ware_type) %>%
summarise(unique_sample_count = n_distinct(Sample)) %>%
ungroup()
print(unique_glaze_type_per_Site, n=36)
write.csv(Comp_Glaze, "./Data/Comp_Glaze.csv", row.names = FALSE)
write.csv(Comp_slip, "./Data/Comp_Slip.csv", row.names = FALSE)
write.csv(Comp_colored_slip, "./Data/Comp_colored_Slip.csv", row.names = FALSE)
Comp_glaze_ternary <- ggtern(
data = Comp_Glaze, aes(x = PbO, y = SiO2, z = alkali,
color = Ware, shape = Region)) +
geom_point(size = 2.5, alpha = 0.7, stroke = 0.5) +
labs(
L = "PbO (%)",
T = "SiO2 (%)",
R = "Alkali (%)"
) +
scale_shape_manual(name = "Region", values = c(15,1,2,3,8,10,6,17)) +
scale_color_manual(name = "Ware", values = c("#1F77B4", "#FF7F0E",  "#2CA02C",  "#D62728", "#9467BD",
"#8C564B", "#E377C2", "#7F7F7F", "#BCBD22", "#17BECF", "#000000", "#AEC7E8", "#FFBB78")) +
theme(
legend.position = "right",
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
tern.panel.background = element_rect(fill = "transparent", color = NA),
tern.plot.background = element_rect(fill = "transparent", color = NA),
plot.title = element_text(hjust = 0.5),
tern.axis.line.T = element_line(color = "black", size = 1.2),
tern.axis.line.L = element_line(color = "black", size = 1.2),
tern.axis.line.R = element_line(color = "black", size = 1.2),
tern.panel.grid.major.T = element_blank(),
tern.panel.grid.major.L = element_blank(),
tern.panel.grid.major.R = element_blank(),
tern.panel.grid.minor.T = element_blank(),
tern.panel.grid.minor.L = element_blank(),
tern.panel.grid.minor.R = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm")
)
png(filename = "./Supplementary_materials/supplementary_figures/Comp_glaze_ternary.png", width = 3600, height = 2400, res=300)
plot(Comp_glaze_ternary)
dev.off()
opaque_set       <- c("Alkali", "Ishkor", "Lustreware", "Opaque")
transparent_set  <- c("Slipware - Qarakhanid", "Slipware - Samanid", "Slipware", "Splashed", "Underglaze", "Monochrome")
other_set        <- c("Kiln Furniture", "Undetermined", "Unknown")
Comp_Glaze <- Comp_Glaze %>%
mutate(
Ware_type = case_when(
Ware %in% opaque_set      ~ "Opaque",
Ware %in% transparent_set ~ "Transparent",
Ware %in% other_set       ~ "Other",
TRUE                      ~ "Other"
),
Ware_type = factor(Ware_type, levels = c("Opaque","Transparent","Other"))
)
unique_glaze_type_per_Site <- Comp_Glaze %>%
group_by(Site, Ware_type) %>%
summarise(unique_sample_count = n_distinct(Sample)) %>%
ungroup()
print(unique_glaze_type_per_Site, n=36)
write.csv(Comp_Glaze, "./Data/Comp_Glaze.csv", row.names = FALSE)
write.csv(Comp_slip, "./Data/Comp_Slip.csv", row.names = FALSE)
write.csv(Comp_colored_slip, "./Data/Comp_colored_Slip.csv", row.names = FALSE)
Comp_glaze_ternary <- ggtern(
data = Comp_Glaze, aes(x = PbO, y = SiO2, z = alkali,
color = Ware, shape = Region)) +
geom_point(size = 2.5, alpha = 0.7, stroke = 0.5) +
labs(
L = "PbO (%)",
T = "SiO2 (%)",
R = "Alkali (%)"
) +
scale_shape_manual(name = "Region", values = c(15,1,2,3,8,10,6,17)) +
scale_color_manual(name = "Ware", values = c("#1F77B4", "#FF7F0E",  "#2CA02C",  "#D62728", "#9467BD",
"#8C564B", "#E377C2", "#7F7F7F", "#BCBD22", "#17BECF", "#000000", "#AEC7E8", "#FFBB78")) +
theme(
legend.position = "right",
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
tern.panel.background = element_rect(fill = "transparent", color = NA),
tern.plot.background = element_rect(fill = "transparent", color = NA),
plot.title = element_text(hjust = 0.5),
tern.axis.line.T = element_line(color = "black", size = 1.2),
tern.axis.line.L = element_line(color = "black", size = 1.2),
tern.axis.line.R = element_line(color = "black", size = 1.2),
tern.panel.grid.major.T = element_blank(),
tern.panel.grid.major.L = element_blank(),
tern.panel.grid.major.R = element_blank(),
tern.panel.grid.minor.T = element_blank(),
tern.panel.grid.minor.L = element_blank(),
tern.panel.grid.minor.R = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm")
)
png(filename = "./Supplementary_materials/supplementary_figures/Comp_glaze_ternary.png", width = 3600, height = 2400, res=300)
plot(Comp_glaze_ternary)
dev.off()
plot(Comp_glaze_ternary)
Comp_glaze_ternary_ware_type <- ggtern(
data = Comp_Glaze, aes(x = PbO, y = SiO2, z = alkali,
color = Ware_type, shape = Region)) +
geom_point(size = 2.5, alpha = 0.7, stroke = 0.5) +
labs(
L = "PbO (%)",
T = "SiO2 (%)",
R = "Alkali (%)"
) +
scale_shape_manual(name = "Region", values = c(15,1,2,3,8,10,6,17)) +
scale_color_manual(name = "Ware Type", values = c("#1F77B4","#FF7F0E","#000000")) +
theme(
legend.position = "right",
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
tern.panel.background = element_rect(fill = "transparent", color = NA),
tern.plot.background = element_rect(fill = "transparent", color = NA),
plot.title = element_text(hjust = 0.5),
tern.axis.line.T = element_line(color = "black", size = 1.2),
tern.axis.line.L = element_line(color = "black", size = 1.2),
tern.axis.line.R = element_line(color = "black", size = 1.2),
tern.panel.grid.major.T = element_blank(),
tern.panel.grid.major.L = element_blank(),
tern.panel.grid.major.R = element_blank(),
tern.panel.grid.minor.T = element_blank(),
tern.panel.grid.minor.L = element_blank(),
tern.panel.grid.minor.R = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm")
)
png(filename = "./Supplementary_materials/supplementary_figures/Comp_glaze_ternary_Ware.png", width = 3600, height = 2400, res=300)
plot(Comp_glaze_ternary_ware_type)
dev.off()
Comp_Glaze_transparent <- filter(Comp_Glaze, `Ware_type` %in% c('Transparent'))
Comp_Glaze_transparent <- Comp_Glaze_transparent %>%
filter(PbO >= 30)
plot(Comp_glaze_ternary_ware_type)
#clean transparent glaze data to ensure their are no N/A values in major elements
detection_limit <- 0.1
replacement_value <- (2/3) * detection_limit
Comp_Glaze_transparent <- Comp_Glaze_transparent %>%
mutate(across(c(MgO, Na2O, FeO, CaO, K2O),
~ ifelse(is.na(.x), replacement_value, .x)))
pc <- prcomp(Comp_Glaze_transparent[,c("PbO", "SiO2", "Al2O3", "Na2O", "MgO", "CaO", "FeO", "K2O")],
center = TRUE,
scale. = TRUE)
pc.dataframe <- as.data.frame(pc$x)
pc.dataframe <- data.frame(pc.dataframe, Ware = Comp_Glaze_transparent$Ware,
Provenance = Comp_Glaze_transparent$Provenance,
Site = Comp_Glaze_transparent$Site,
Sample = Comp_Glaze_transparent$Sample,
Region = Comp_Glaze_transparent$Region)
# Create element loadings scaled for visualization
loadings <- as.data.frame(pc$rotation)
loadings_scaled <- loadings*8
loadings_scaled$Variable <- rownames(loadings)
# Calculate percentage contribution of each PC
total_variance <- sum(pc$sdev^2)
pc_contributions <- (pc$sdev^2 / total_variance) * 100
print(pc_contributions)
NAA_pc.dataframe <- pc.dataframe %>%
filter(Provenance %in% c("BUK", "TASH", "SAMK", "TAZ - Group 3", "PAY 2"))
NAA_pc.dataframe <- NAA_pc.dataframe %>%
filter(Site %in% c("Bukhara", "Tashkent", "Paykend", "Taraz"))
Site_pc.dataframe <- pc.dataframe %>%
filter(Site %in% c("Akhsiket", "Dandanakan", "Kuva", "Paykend", "Termez", "Aktobe", "Bektobe",
"Kulan", "Lower Barskhan", "Tamdy", "Taraz", "Laskhar-i Bazar",
"Bust")| Provenance == "N/A")
Site_pc.dataframe <- Site_pc.dataframe %>% filter(!(Provenance %in% c("BUK", "TASH", "TAZ - Group 3", "SAMK", "PAY 2")))
ellipse_NAA_pc.dataframe <- pc.dataframe %>%
filter(Provenance %in% c("BUK", "TASH"))
ellipse_region_pc.dataframe <- pc.dataframe %>%
filter(Region %in% c("Chach", "Transoxiana"))
ellipse_ware_pc.dataframe <- pc.dataframe %>%
filter(Provenance %in% c("BUK", "TASH", "SAMK", "TAZ - Group 3", "PAY 2", "N/A"))
ellipse_ware_pc.dataframe <- ellipse_ware_pc.dataframe %>%
filter(Ware %in% c("Slipware - Samanid", "Slipware - Qarakhanid"))
ellipse_ware_pc.dataframe <- ellipse_ware_pc.dataframe %>%
filter(Site %in% c("Bukhara", "Tashkent", "Paykend", "Taraz"))
#plot by paste compositional group with element loadings
PCregion <- ggplot() +
geom_point(
data = Site_pc.dataframe,
aes(PC1, PC2, color = Ware, shape = Site),
show.legend = c(color = TRUE, shape = TRUE)
) +
geom_point(
data = NAA_pc.dataframe,
aes(PC1, PC2, color = Ware, shape = Provenance)
) +
stat_ellipse(
data = ellipse_ware_pc.dataframe,
aes(PC1, PC2, group = Ware, color = Ware)
) +
theme_minimal() +
labs(x = "PC1 (43.3%)", y = "PC2 (16.2%)") +
coord_cartesian(xlim = c(-5, 7.5), ylim = c(-5, 4)) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
legend.position = "right",
legend.box = "horizontal"
) +
scale_shape_manual(
name = "Provenance/Site",
values = c(17, 1, 15, 16, 18, 2,3,4,5,6,8,9,10,11,12,13,14,7,0, 20)
) +
scale_color_manual(
name = "Ware",
values = c("#E41A1C", "#999999", "#4DAF4A", "#377EB8", "#984EA3", "#FF7F00")
) +
guides(
shape = guide_legend(order = 1, direction = "vertical", ncol = 1),
color = guide_legend(order = 2, direction = "vertical", ncol = 1)
)
PCregion
jpeg(filename = "./Figures/Figure9a.jpg", width = 2800, height = 1600, res=300)
print(PCregion) + theme(axis.line = element_line(color = "black", linewidth = 1, linetype = 1)) +
geom_segment(data = loadings_scaled, aes(x = 0, y = 0, xend = PC1, yend = PC2), arrow = arrow(length = unit(0.2, "cm")), color = "black") +
geom_text(data = loadings_scaled, aes(x = PC1, y = PC2, label = Variable), hjust = 0.25, vjust = 1.25, size = 5, color = "black")
dev.off()
PCComp <- ggplot() +
geom_point(data = pc.dataframe, aes(x = PC1, y = PC2, color = "comparative site", shape = Ware)) +
geom_point(data = NAA_pc.dataframe, aes(x =PC1, y = PC2, color = Provenance, shape = Ware))+
theme_minimal() +
stat_ellipse(data = ellipse_NAA_pc.dataframe, aes(x =PC1, y = PC2, group = Provenance, color = Provenance))+
labs(x = "PC1 (43.3%)", y = "PC2 (16.2%)") +
coord_cartesian(xlim = c(-5, 7.5), ylim = c(-5, 4)) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
scale_color_manual(
name   = "Provenance",
breaks = c("BUK", "SAMK", "TASH", "TAZ - Group 3", "comparative site"),
values = c("BUK" = "#CC6677",
"SAMK" = "#882255",
"TASH" = "#44AA99",
"TAZ - Group 3" = "#117733",
"comparative site" = "gray"),
drop = FALSE
) +
scale_shape_manual(name = "Ware", values = c(1, 6, 16, 17, 8, 7)) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
legend.position = "right",
legend.box = "horizontal"
)
print(PCComp) + theme(axis.line = element_line(color = "black", linewidth = 1, linetype = 1))
jpeg(filename = "./Figures/Figure9b.jpg", width = 2800, height = 1600, res=300)
print(PCComp) + theme(axis.line = element_line(color = "black", linewidth = 1, linetype = 1))
dev.off()
provenanced_glaze_data <- Comp_Glaze_transparent
provenanced_glaze_data <- provenanced_glaze_data %>%
group_by(Sample, Site, Region, Ware, Provenance) %>%
summarise(
across(all_of(oxide_columns_master), ~ mean(.x, na.rm = TRUE)),
Count = sum(Count, na.rm = TRUE),
.groups = "drop"
)
provenanced_glaze_data$Provenance <- as.factor(provenanced_glaze_data$Provenance)
provenanced_glaze_data <- provenanced_glaze_data %>%
filter(Provenance %in% c("BUK", "TASH", "TAZ - Group 3", "SAMK", "N/A"))
provenanced_glaze_data <- provenanced_glaze_data %>%
filter(Site %in% c("Bukhara", "Tashkent", "Paykend", "Taraz"))
provenanced_glaze_data <- provenanced_glaze_data %>%
filter(Ware %in% c("Slipware - Qarakhanid", "Slipware - Samanid", "Splashed", "Monochrome"))
provenanced_glaze_data_ellipse <- provenanced_glaze_data %>%
filter(Ware %in% c("Splashed"))
recovery_glaze_data <- Comp_Glaze_transparent
recovery_glaze_data <- recovery_glaze_data %>%
group_by(Sample, Site, Region, Ware, Provenance) %>%
summarise(
across(all_of(oxide_columns_master), ~ mean(.x, na.rm = TRUE)),
Count = sum(Count, na.rm = TRUE),
.groups = "drop"
)
recovery_glaze_data$Site <- as.factor(recovery_glaze_data$Site)
recovery_glaze_data <- recovery_glaze_data %>% filter(Site %in% c("Akhsiket", "Dandanakan", "Kuva", "Termez", "Aktobe", "Bektobe",
"Kulan", "Lower Barskhan", "Tamdy", "Taraz", "Laskhar-i Bazar",
"Bust"))
recovery_glaze_data <- recovery_glaze_data %>% filter(!(Provenance %in% c("BUK", "TASH", "TAZ - Group 3", "SAMK", "N/A")))
PbO_alkali <- ggplot() +
geom_point(data = recovery_glaze_data,
aes(x = Na2O+K2O+MgO+CaO, y = PbO, shape = Ware, color = "comparative site"),
size = 3) +
geom_point(data = provenanced_glaze_data,
aes(x = Na2O+K2O+MgO+CaO, y = PbO, shape = Ware, color = Provenance),
size = 3) +
labs(x = "Alkali (Na2O + K2O + MgO + CaO wt%)",
y = "PbO (wt%)") +
coord_cartesian(ylim = c(38,72), xlim = c(0, 8)) +
scale_shape_manual(name = "Ware",
values = c(8,1,2,16,3,4,5,6,8,9,10,11,12,13,14,7,0))  +
scale_color_manual(
name   = " ",
breaks = c("BUK", "SAMK", "TASH", "TAZ - Group 3", "N/A", "comparative site"),
values = c("BUK" = "#CC6677",
"SAMK" = "#882255",
"TASH" = "#44AA99",
"TAZ - Group 3" = "#117733",
"N/A" = "black",
"comparative site" = "gray")) +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
legend.position = "right",
legend.box = "horizontal") +
guides(color = guide_legend(order = 2, direction = "vertical"),
shape = guide_legend(order = 1, direction = "vertical"))
PbO_alkali
jpeg(filename = "./Figures/Figure10_a.jpg", width = 2800, height = 1600, res=300)
print(PbO_alkali)
dev.off()
subs <- c("PbO", "MnO", "FeO", "CoO", "CuO", "Cr2O3")
elts <- c("SiO2", "Al2O3", "K2O", "CaO")
elts_norm <- c("SiO2_norm", "Al2O3_norm", "K2O_norm", "CaO_norm")
# Normalization of slip and glaze
Comp_PbO_removed <- comparative_normalized_data %>%
rowwise() %>%
mutate(
total = sum(c_across(all_of(elts)), na.rm = TRUE) + sum(c_across(all_of(subs)), na.rm = TRUE),
denominator = total - sum(c_across(all_of(subs)), na.rm = TRUE),
across(all_of(elts), ~ .x / denominator * 100, .names = "{.col}_norm")
) %>%
ungroup() %>%
select(-total, -denominator)
Comp_Slips_glaze <- Comp_PbO_removed %>%
filter(Component == "Glaze", Glaze_or_slip_color != "Not over slip") %>%
group_by(Sample, Site, Region, Ware, Provenance) %>%
summarise(
across(all_of(elts), ~ mean(.x, na.rm = TRUE), .names = "Raw_{.col}_glaze"),
across(all_of(elts_norm), ~ mean(.x, na.rm = TRUE), .names = "{.col}_glaze"),
Count = sum(Count, na.rm = TRUE),
.groups = "drop"
)
Comparative_slip <- Comp_PbO_removed %>%
filter(Component == "White Slip") %>%
filter(!Glaze_or_slip_color %in% c('Not under glaze')) %>%
select(Sample, Site, Region, Ware, Component, Provenance, Glaze_or_slip_color, all_of(elts)) %>%
group_by(Sample, Site, Region, Ware, Provenance) %>%
summarise(
across(all_of(elts), ~ mean(.x, na.rm = TRUE), .names = "Raw_{.col}_slip"),
.groups = "drop"
)
Comparative_slip_norm <- Comp_PbO_removed %>%
filter(Component == "White Slip") %>%
filter(!Glaze_or_slip_color %in% c('Not under glaze')) %>%
select(Sample, Site, Region, Ware, Component, Provenance, Glaze_or_slip_color, all_of(elts_norm)) %>%
group_by(Sample, Site, Region, Ware, Provenance) %>%
summarise(
# values for slip
across(all_of(elts_norm), ~ mean(.x, na.rm = TRUE), .names = "{.col}_slip"),
.groups = "drop"
)
# Join raw and normalized data for glaze and slip
wide_slip_data <- Comp_Slips_glaze %>%
inner_join(Comparative_slip, by = c("Sample", "Site", "Region", "Ware", "Provenance")) %>%
inner_join(Comparative_slip_norm, by = c("Sample", "Site", "Region", "Ware", "Provenance"))
# Final cleaning
wide_slip_data <- wide_slip_data %>%
mutate(
across(starts_with("SiO2"), as.numeric),
across(starts_with("Al2O3"), as.numeric),
across(starts_with("K2O"), as.numeric),
across(starts_with("CaO"), as.numeric)
)
provenanced_ceramics_data <- wide_slip_data
provenanced_ceramics_data$Provenance <- as.factor(provenanced_ceramics_data$Provenance)
provenanced_ceramics_data <- provenanced_ceramics_data %>%
filter(Provenance %in% c("BUK", "TASH", "TAZ - Group 3", "SAMK"))
provenanced_ceramics_data <- provenanced_ceramics_data %>%
filter(Site %in% c("Bukhara", "Tashkent", "Paykend", "Taraz"))
provenanced_ceramics_data <- provenanced_ceramics_data %>%
filter(Ware %in% c("Slipware - Qarakhanid", "Slipware - Samanid", "Splashed", "Monochrome"))
provenanced_ceramics_data_ellipse <- provenanced_ceramics_data %>%
filter(Provenance %in% c("BUK", "TASH"))
recovery_ceramics_data <- wide_slip_data
recovery_ceramics_data$Site <- as.factor(recovery_ceramics_data$Site)
recovery_ceramics_data <- recovery_ceramics_data %>% filter(Site %in% c("Akhsiket", "Dandanakan", "Kuva", "Termez", "Aktobe", "Bektobe",
"Kulan", "Lower Barskhan", "Tamdy", "Taraz", "Laskhar-i Bazar",
"Bust")| Provenance == "N/A")
recovery_ceramics_data <- recovery_ceramics_data %>% filter(!(Provenance %in% c("BUK", "TASH", "TAZ - Group 3", "SAMK")))
## visualising glaze and slip interactions
combined_plot_Al2O3 <- ggplot() +
geom_point(data = provenanced_ceramics_data, aes(x = Al2O3_norm_slip, y = Al2O3_norm_glaze,
color = Provenance, shape = Provenance),
size = 4) +
geom_point(data = recovery_ceramics_data, aes(x = Al2O3_norm_slip, y = Al2O3_norm_glaze, color = "comparative site", shape = Site),
size = 2) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
stat_ellipse(data = provenanced_ceramics_data_ellipse,
aes(x = Al2O3_norm_slip, y = Al2O3_norm_glaze, group = Provenance, color = Provenance),
level = 0.90, geom = "path") +
labs(x = "White Slip (Al2O3* wt%)",
y = "Glaze (Al2O3* wt%)") +
scale_shape_manual(name = "Provenance/Site", values = c(17, 15, 16, 18, 1,2,3,4,5,6,8,9,10,11,12,13,14,7,0)) +
scale_color_manual(
name   = " ",
breaks = c("BUK", "SAMK", "TASH", "TAZ - Group 3", "comparative site"),
values = c("BUK" = "#CC6677",
"SAMK" = "#882255",
"TASH" = "#44AA99",
"TAZ - Group 3" = "#117733",
"comparative site" = "gray")) +
coord_cartesian(xlim = c(0, 42), ylim = c(0, 42)) +
theme_minimal() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
legend.position = "right",
legend.box = "horizontal"
)  +
guides(
color = guide_legend(order = 2, direction = "vertical"),
shape = guide_legend(order = 1, direction = "vertical")
)
print(combined_plot_Al2O3)
jpeg(filename = "./Figures/Figure7a.jpg", width = 2800, height = 1600, res=300)
print(combined_plot_Al2O3)
dev.off()
combined_plot_SiO2 <- ggplot() +
geom_point(data = provenanced_ceramics_data, aes(x = SiO2_norm_slip, y = SiO2_norm_glaze, color = Provenance, shape = Provenance),
size = 4) +
geom_point(data = recovery_ceramics_data, aes(x = SiO2_norm_slip, y = SiO2_norm_glaze, color = "comparative site", shape = Site),
size = 2) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
stat_ellipse(data = provenanced_ceramics_data_ellipse,
aes(x = SiO2_norm_slip, y = SiO2_norm_glaze, group = Provenance, color = Provenance),
level = 0.90, geom = "path") +
labs(x = "White Slip (SiO2* wt%)",
y = "Glaze (SiO2* wt%)") +
scale_shape_manual(name = "Provenance/Site", values = c(17, 15, 16, 18, 1,2,3,4,5,6,8,9,10,11,12,13,14,7,0)) +
scale_color_manual(
name   = " ",
breaks = c("BUK", "SAMK", "TASH", "TAZ - Group 3", "comparative site"),  # desired order
values = c("BUK" = "#CC6677",
"SAMK" = "#882255",
"TASH" = "#44AA99",
"TAZ - Group 3" = "#117733",
"comparative site" = "gray")) +
coord_cartesian(xlim = c(50,100), ylim = c(50,100)) +
theme_minimal() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
legend.position = "right",
legend.box = "horizontal"
)  +
guides(
color = guide_legend(order = 2, direction = "vertical"),
shape = guide_legend(order = 1, direction = "vertical")
)
print(combined_plot_SiO2)
jpeg(filename = "./Figures/Figure7b.jpg", width = 2800, height = 1600, res=300)
print(combined_plot_SiO2)
dev.off()
combined_plot_CaO_Al2O3 <- ggplot() +
geom_point(data = provenanced_ceramics_data,
aes(x = Raw_CaO_slip, y = Raw_Al2O3_slip, color = Ware, shape = Provenance),
size = 4) +
geom_point(data = recovery_ceramics_data,
aes(x = Raw_CaO_slip, y = Raw_Al2O3_slip, color = Ware, shape = Site),
size = 2) +
labs(x = "log(CaO slip (wt%))",
y = "Al2O3 slip (wt%)") +
scale_shape_manual(name = "Provenance/Site",
values = c(17,15,16,18,1,2,3,4,5,6,8,9,10,11,12,13,14,7,0)) +
scale_color_manual(name = "Ware",
values = c("#4DAF4A","#377EB8","#984EA3","#a65628",
"#E41A1C","#999999","#FF7F00","#000000")) +
scale_x_log10(
breaks = c(0.1, 0.2, 0.5, 1, 2, 5, 10),
) +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
legend.position = "right",
legend.box = "horizontal") +
guides(color = guide_legend(order = 2, direction = "vertical"),
shape = guide_legend(order = 1, direction = "vertical"))
combined_plot_CaO_Al2O3
jpeg(filename = "./Figures/Figure7c.jpg", width = 2800, height = 1600, res=300)
print(combined_plot_CaO_Al2O3)
dev.off()
citation("rio")
citation("dplyr")
citation("ggplot2")
citation("ggtern")
citation("scales")
